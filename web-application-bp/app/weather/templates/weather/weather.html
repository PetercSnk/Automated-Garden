{% extends "core/core.html" %}
{% block head %}
    <title>Home</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
{% endblock %}
{% block content %}
    <h1>Weather Forecast</h1>
    <div class="get-weather-btn">
        <form method="post">
            <button type="submit" class="normal-btn" name="get-weather">Get Weather</button>
        </form>
    </div>
    {% if render %}
        <h4>Date: {{ format_date(date) }} Sunrise: {{ sunrise }} Sunset: {{ sunset }}</h4>
        <h4>Weather: {{ description }}</h4>
        <div class="get-day-btns">
            {% for daily in daily_all %}
                <a class="nav-item" href="/weather/{{ daily.id }}">{{ format_date(daily.date) }}</a>
            {% endfor %}
        </div>
        <figure class="highcharts-figure">
            <div id="container"></div>
        </figure>
        <script>
            Highcharts.chart("container", {
                chart: {
                    zooming: {
                        type: "xy"
                    }
                },
                title: {
                    text: "Weather for {{ format_date(date) }}",
                    align: "left"
                },
                xAxis: [{
                    categories: {{ time }},
                    crosshair: true
                }],
                yAxis: [{
                    labels: {
                        format: "{value} mm",
                        style: {
                            color: Highcharts.getOptions().colors[0]
                        }
                    },
                    title: {
                        text: "Precipitation",
                        style: {
                            color: Highcharts.getOptions().colors[0]
                        }
                    }
                }, {
                    labels: {
                        format: "{value} °C",
                        style: {
                            color: Highcharts.getOptions().colors[1]
                        }
                    },
                    title: {
                        text: "Temperature",
                        style: {
                            color: Highcharts.getOptions().colors[1]
                        }
                    }
                }, 
                    opposite: true
                }],
                tooltip: {
                    shared: true
                },
                legend: {
                    align: "left",
                    verticalAlign: "top",
                    backgroundColor:
                        Highcharts.defaultOptions.legend.backgroundColor || // theme
                        "rgba(255,255,255,0.25)"
                },
                series: [{
                    name: "Precipitation",
                    type: "column",
                    yAxis: 1,
                    data: [
                        45.7, 37.0, 28.9, 17.1, 39.2, 18.9, 90.2, 78.5, 74.6,
                        18.7, 17.1, 16.0
                    ],
                    tooltip: {
                        valueSuffix: " mm"
                    }

                }, {
                    name: "Temperature",
                    type: "spline",
                    data: [
                        -11.4, -9.5, -14.2, 0.2, 7.0, 12.1, 13.5, 13.6, 8.2,
                        -2.8, -12.0, -15.5
                    ],
                    tooltip: {
                        valueSuffix: "°C"
                    }
                }]
            });  
        </script>
    {% endif %}
{% endblock %}
